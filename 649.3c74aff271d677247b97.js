(self.webpackChunksoftuni_angular_exam=self.webpackChunksoftuni_angular_exam||[]).push([[649],{649:(t,e,n)=>{"use strict";n.r(e),n.d(e,{CommentsModule:()=>A});var r=n(9843),o=n(1116),m=n(1462),c=n(5366),i=n(7653),s=n(8512);let u=(()=>{class t{constructor(){this.currentCommentId="",this.currentCommentIdSubject=new s.X(this.currentCommentId)}setCurrentCommentId(t){this.currentCommentId=t,this.currentCommentIdSubject.next(this.currentCommentId)}clearCurrentCommentId(){this.currentCommentId="",this.currentCommentIdSubject.next(this.currentCommentId)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=c.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var d=n(1858),p=n(6659);let a=(()=>{class t{constructor(t,e,n){this._authService=t,this._firestoreCollections=e,this._currentCommentId=n}ngOnInit(){this.commnetForm=new m.cw({commentArea:new m.NI(null,m.kI.required)}),this._userSubscription=this._authService.user.subscribe(t=>{this.user=t}),this._currentCommentIdSubscription=this._currentCommentId.currentCommentIdSubject.subscribe(t=>{this.currentCommentId=t})}ngOnDestroy(){this._userSubscription.unsubscribe(),this._currentCommentIdSubscription.unsubscribe()}onSubmitComment(t){if(t.invalid)return;const e=this.user.name,n=this.user.email,r=d.Z.firestore.Timestamp.now(),o=t.value.commentArea.trim();this.currentCommentId?this._firestoreCollections.setReply({userName:e,email:n,date:r,description:o,commentId:this.currentCommentId}).then(()=>{t.reset(),this._currentCommentId.clearCurrentCommentId()},t=>{}):this._firestoreCollections.setComment({userName:e,email:n,date:r,description:o}).then(()=>{t.reset()},t=>{})}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(p.e),c.Y36(i.P),c.Y36(u))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-comment-form"]],decls:8,vars:3,consts:[[3,"formGroup","ngSubmit"],["placeholder","Type your comment...","formControlName","commentArea",1,"comments-textarea"],["type","submit",3,"disabled"],[1,"error-msg"]],template:function(t,e){1&t&&(c.TgZ(0,"form",0),c.NdJ("ngSubmit",function(){return e.onSubmitComment(e.commnetForm)}),c.TgZ(1,"div"),c._UZ(2,"textarea",1),c.qZA(),c.TgZ(3,"div"),c.TgZ(4,"button",2),c._uU(5,"Add your comment"),c.qZA(),c.TgZ(6,"p",3),c._uU(7),c.qZA(),c.qZA(),c.qZA()),2&t&&(c.Q6J("formGroup",e.commnetForm),c.xp6(4),c.Q6J("disabled",!e.commnetForm.valid),c.xp6(3),c.Oqu(""))},directives:[m._Y,m.JL,m.sg,m.Fj,m.JJ,m.u],styles:[""]}),t})();function l(t,e){if(1&t&&(c.TgZ(0,"div"),c.TgZ(1,"p"),c._uU(2),c.qZA(),c.TgZ(3,"p"),c._uU(4),c.ALo(5,"date"),c.ALo(6,"date"),c.qZA(),c.TgZ(7,"p"),c._uU(8),c.qZA(),c.qZA()),2&t){const t=e.$implicit;c.xp6(2),c.Oqu(t.userName),c.xp6(2),c.AsE(" ",c.xi3(5,4,t.date.toDate(),"dd.MM.yyyy")," at ",c.xi3(6,7,t.date.toDate(),"HH:mm")," "),c.xp6(4),c.Oqu(t.description)}}function C(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"button",3),c.NdJ("click",function(){c.CHM(t);const e=c.oxw();return e.onReply(e.comment.id)}),c._uU(1,"Reply"),c.qZA()}}function f(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"button",3),c.NdJ("click",function(){return c.CHM(t),c.oxw().closeReply()}),c._uU(1,"Close"),c.qZA()}}function I(t,e){1&t&&(c.TgZ(0,"div"),c._UZ(1,"app-comment-form"),c.qZA())}let g=(()=>{class t{constructor(t){this._currentCommentId=t}ngOnInit(){this._currentCommentIdSubscription=this._currentCommentId.currentCommentIdSubject.subscribe(t=>{this.currentCommentId=t})}ngOnDestroy(){this._currentCommentIdSubscription.unsubscribe()}onReply(t){this._currentCommentId.setCurrentCommentId(t)}closeReply(){this._currentCommentId.clearCurrentCommentId()}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(u))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-comment"]],inputs:{comment:"comment"},decls:18,vars:14,consts:[[4,"ngFor","ngForOf"],[3,"click",4,"ngIf"],[4,"ngIf"],[3,"click"]],template:function(t,e){1&t&&(c.TgZ(0,"div"),c.TgZ(1,"div"),c.TgZ(2,"div"),c.TgZ(3,"p"),c._uU(4),c.qZA(),c.TgZ(5,"p"),c._uU(6),c.ALo(7,"date"),c.ALo(8,"date"),c.qZA(),c.TgZ(9,"p"),c._uU(10),c.qZA(),c.qZA(),c.TgZ(11,"div"),c.YNc(12,l,9,10,"div",0),c.qZA(),c.qZA(),c.TgZ(13,"div"),c.YNc(14,C,2,0,"button",1),c.YNc(15,f,2,0,"button",1),c.qZA(),c.YNc(16,I,2,0,"div",2),c.qZA(),c._UZ(17,"hr")),2&t&&(c.xp6(4),c.Oqu(e.comment.userName),c.xp6(2),c.AsE(" ",c.xi3(7,8,e.comment.date.toDate(),"dd.MM.yyyy")," at ",c.xi3(8,11,e.comment.date.toDate(),"HH:mm")," "),c.xp6(4),c.Oqu(e.comment.description),c.xp6(2),c.Q6J("ngForOf",e.comment.replies),c.xp6(2),c.Q6J("ngIf",e.currentCommentId!==e.comment.id),c.xp6(1),c.Q6J("ngIf",e.currentCommentId==e.comment.id),c.xp6(1),c.Q6J("ngIf",e.currentCommentId==e.comment.id))},directives:[o.sg,o.O5,a],pipes:[o.uU],styles:[""]}),t})();function h(t,e){1&t&&c._UZ(0,"app-comment",3),2&t&&c.Q6J("comment",e.$implicit)}function Z(t,e){if(1&t&&(c.TgZ(0,"div"),c.YNc(1,h,1,1,"app-comment",2),c.qZA()),2&t){const t=c.oxw();c.xp6(1),c.Q6J("ngForOf",t.comments)}}function b(t,e){1&t&&(c.TgZ(0,"div"),c._UZ(1,"app-comment-form"),c.qZA())}let _=(()=>{class t{constructor(t,e){this._firestoreCollections=t,this._currentCommentId=e}ngOnInit(){this._firestoreCollections.getComments().subscribe(t=>{this.comments=t.map(t=>Object.assign({id:t.payload.doc.id},t.payload.doc.data()))},t=>{}),this._currentCommentIdSubscription=this._currentCommentId.currentCommentIdSubject.subscribe(t=>{this.currentCommentId=t})}ngOnDestroy(){this._currentCommentIdSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(i.P),c.Y36(u))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-comments"]],decls:4,vars:2,consts:[[1,"container"],[4,"ngIf"],[3,"comment",4,"ngFor","ngForOf"],[3,"comment"]],template:function(t,e){1&t&&(c.TgZ(0,"div"),c.TgZ(1,"div",0),c.YNc(2,Z,2,1,"div",1),c.YNc(3,b,2,0,"div",1),c.qZA(),c.qZA()),2&t&&(c.xp6(2),c.Q6J("ngIf",e.comments),c.xp6(1),c.Q6J("ngIf",!e.currentCommentId))},directives:[o.O5,o.sg,g,a],styles:[""]}),t})(),A=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[o.ez,m.UX,r.Bz.forChild([{path:"",component:_}])]]}),t})()}}]);